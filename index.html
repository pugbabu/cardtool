<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°çº¢ä¹¦æç®€å¡ç‰‡ç”Ÿæˆå·¥å…·ï¼ˆå¢å¼ºç‰ˆï¼‰</title>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            background-color: #F8F9FA;
            font-family: 'Source Han Sans CN', 'Roboto', Helvetica, Arial, sans-serif;
            color: #333;
            line-height: 1.6;
            height: 100vh;
        }

        .tool-container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            height: 100vh;
        }

        /* é…ç½®é¢æ¿ */
        .config-panel {
            flex: 1;
            min-width: 400px;
            background: #FFFFFF;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.05);
            height: 100%;
            overflow: auto;
        }

        .panel-title {
            font-size: 22px;
            font-weight: 800;
            color: #000;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .panel-title span {
            color: var(--theme-accent, #2A00FF);
        }

        .config-group {
            margin-bottom: 24px;
            border-bottom: 1px solid #F5F7FA;
            padding-bottom: 16px;
        }

        .config-group:last-child {
            border-bottom: none;
        }

        .group-label {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 12px;
            color: #000;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .group-label small {
            font-size: 12px;
            font-weight: normal;
            color: #666;
        }

        .form-control {
            width: 100%;
            padding: 10px 14px;
            border: 1px solid #E0E0E0;
            border-radius: 8px;
            font-size: 14px;
            margin-bottom: 12px;
            font-family: inherit;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--theme-accent, #2A00FF);
            box-shadow: 0 0 0 2px rgba(var(--theme-accent-rgb, 42, 0, 255), 0.1);
        }

        textarea.form-control {
            min-height: 80px;
            resize: vertical;
        }

        .component-category {
            margin-bottom: 16px;
        }

        .category-title {
            font-size: 14px;
            font-weight: 700;
            color: #666;
            margin-bottom: 8px;
            padding-left: 4px;
        }

        .component-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 16px;
        }

        .component-item {
            padding: 8px 16px;
            border: 1px solid #E0E0E0;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .component-item:hover {
            border-color: var(--theme-accent, #2A00FF);
            background: rgba(var(--theme-accent-rgb, 42, 0, 255), 0.03);
        }

        .component-item.active {
            background: var(--theme-accent, #2A00FF);
            color: #FFFFFF;
            border-color: var(--theme-accent, #2A00FF);
        }

        .step-item {
            background: #F5F7FA;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 12px;
            position: relative;
        }

        .step-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .step-title {
            font-weight: 700;
            font-size: 15px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .step-type-tag {
            font-size: 11px;
            padding: 2px 6px;
            border-radius: 4px;
            background: rgba(var(--theme-accent-rgb, 42, 0, 255), 0.1);
            color: var(--theme-accent, #2A00FF);
        }

        .step-actions {
            display: flex;
            gap: 8px;
        }

        .action-btn {
            background: none;
            border: none;
            font-size: 14px;
            color: #666;
            cursor: pointer;
            padding: 4px 8px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .action-btn:hover {
            background: #E5E5E5;
            color: #000;
        }

        .action-btn.primary {
            color: var(--theme-accent, #2A00FF);
        }

        .btn {
            display: inline-block;
            padding: 12px 24px;
            background: var(--theme-accent, #2A00FF);
            color: #FFFFFF;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            font-family: inherit;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn:hover {
            background: var(--theme-accent-dark, #1A00CC);
            transform: translateY(-2px);
        }

        .btn-outline {
            background: none;
            border: 1px solid var(--theme-accent, #2A00FF);
            color: var(--theme-accent, #2A00FF);
            margin-right: 12px;
        }

        .btn-outline:hover {
            background: rgba(var(--theme-accent-rgb, 42, 0, 255), 0.05);
            transform: none;
        }

        /* ä¸»é¢˜è‰²é…ç½®é¢æ¿ */
        .theme-colors-container {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
            margin-bottom: 16px;
        }

        .theme-color-item {
            padding: 10px;
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            font-size: 12px;
            font-weight: 600;
            transition: transform 0.2s;
        }

        .theme-color-item:hover {
            transform: translateY(-2px);
        }

        .theme-color-preview {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin: 0 auto 8px;
            border: 2px solid white;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .custom-color-picker {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-top: 12px;
        }

        .color-input {
            width: 40px;
            height: 40px;
            padding: 0;
            border: none;
            cursor: pointer;
            border-radius: 8px;
            overflow: hidden;
        }

        .color-input::-webkit-color-swatch-wrapper {
            padding: 0;
        }

        .color-input::-webkit-color-swatch {
            border: none;
            border-radius: 6px;
        }

        .custom-hex-input {
            flex: 1;
        }

        /* é¢„è§ˆé¢æ¿ */
        .preview-panel {
            flex: 1.5;
            min-width: 600px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .preview-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        .preview-title {
            font-size: 20px;
            font-weight: 800;
            color: #000;
        }

        .preview-tip {
            font-size: 14px;
            color: #666;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .card-preview {
            width: 600px;
            height: 800px;
            background-color: #FFFFFF;
            position: relative;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            margin: 0 auto;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            border-radius: 8px;
        }

        /* å¡ç‰‡æ ·å¼ï¼ˆå¢å¼ºç‰ˆç»„ä»¶ï¼‰ */
        :root {
            --theme-black: #000000;
            --theme-grey: #666666;
            --theme-light-grey: #F5F7FA;
            --theme-accent: #2A00FF;
            --theme-accent-dark: #1A00CC;
            --theme-accent-light: rgba(42, 0, 255, 0.1);
            --theme-accent-rgb: 42, 0, 255;
            --border-color: #E0E0E0;
            --success-color: #00C48C;
            --info-color: #4299E1;
            --warning-color: #FF7D00;
            --danger-color: #F53F3F;
            --note-color: #9F7AEA;
            --tip-color: #38B2AC;
        }

        .card-header {
            background-color: #FFFFFF;
            padding: 30px 40px 15px;
            border-bottom: 4px solid var(--theme-accent);
            display: flex;
            align-items: baseline;
            justify-content: space-between;
        }

        .card-step-indicator {
            font-size: 72px;
            font-weight: 900;
            color: var(--theme-accent);
            line-height: 0.8;
            font-style: italic;
        }

        .card-step-title-group {
            text-align: right;
        }

        .card-step-label {
            display: block;
            font-size: 14px;
            font-weight: 700;
            color: var(--theme-black);
            letter-spacing: 1.5px;
            text-transform: uppercase;
        }

        .card-main-title {
            font-size: 24px;
            font-weight: 800;
            color: var(--theme-black);
            margin-top: 3px;
        }

        .card-content {
            padding: 30px 40px;
            flex-grow: 1;
            position: relative;
        }

        .card-timeline-line {
            position: absolute;
            left: 54px;
            top: 40px;
            bottom: 30px;
            width: 2px;
            background-color: var(--theme-light-grey);
            z-index: 0;
        }

        .card-step-row {
            display: flex;
            margin-bottom: 22px;
            position: relative;
            z-index: 1;
        }

        .card-step-num {
            flex-shrink: 0;
            width: 30px;
            height: 30px;
            background-color: var(--theme-black);
            color: #FFFFFF;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 15px;
            margin-right: 18px;
            margin-top: 1px;
        }

        .card-step-content {
            flex-grow: 1;
        }

        .card-step-text {
            font-size: 16px;
            color: #333;
            line-height: 1.4;
            font-weight: 500;
        }

        .card-step-text strong {
            color: var(--theme-accent);
        }

        /* åŸºç¡€ç»„ä»¶æ ·å¼ */
        .card-prompt-box {
            background-color: var(--theme-light-grey);
            border-left: 4px solid var(--theme-accent);
            padding: 12px 16px;
            margin-top: 8px;
            border-radius: 0 6px 6px 0;
        }

        .card-prompt-text {
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 13px;
            color: #444;
            line-height: 1.5;
        }

        .card-option-box {
            background-color: var(--theme-accent-light);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 10px 14px;
            margin-top: 8px;
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .card-option-item {
            font-size: 13px;
            color: var(--theme-black);
            display: flex;
            align-items: center;
        }

        .card-option-icon {
            margin-right: 8px;
            font-size: 14px;
        }

        .card-success-box {
            background-color: rgba(0, 196, 140, 0.08);
            border-left: 4px solid var(--success-color);
            padding: 10px 14px;
            margin-top: 8px;
            border-radius: 0 6px 6px 0;
            display: flex;
            align-items: flex-start;
        }

        .card-success-icon {
            color: var(--success-color);
            margin-right: 8px;
            font-size: 16px;
            margin-top: 1px;
        }

        .card-success-content {
            font-size: 13px;
            color: #333;
            line-height: 1.4;
        }

        .card-format-box {
            background-color: rgba(66, 153, 225, 0.05);
            border: 1px solid var(--info-color);
            border-radius: 6px;
            padding: 10px 14px;
            margin-top: 8px;
        }

        .card-format-header {
            font-size: 13px;
            color: var(--info-color);
            font-weight: 600;
            margin-bottom: 4px;
        }

        .card-format-list {
            font-size: 12px;
            color: var(--theme-grey);
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .card-action-hint {
            background-color: var(--theme-accent-light);
            border-left: 4px solid var(--theme-accent);
            padding: 10px 14px;
            margin-top: 8px;
            border-radius: 0 6px 6px 0;
        }

        .card-action-text {
            font-size: 13px;
            color: var(--theme-black);
            line-height: 1.4;
        }

        /* æ–°å¢ç»„ä»¶æ ·å¼ */
        .card-note-box {
            background-color: rgba(159, 122, 234, 0.08);
            border-left: 4px solid var(--note-color);
            padding: 12px 16px;
            margin-top: 8px;
            border-radius: 0 6px 6px 0;
        }

        .card-note-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 6px;
            font-size: 14px;
            font-weight: 600;
            color: var(--note-color);
        }

        .card-note-content {
            font-size: 13px;
            color: #333;
            line-height: 1.4;
        }

        .card-warning-box {
            background-color: rgba(255, 125, 0, 0.08);
            border-left: 4px solid var(--warning-color);
            padding: 12px 16px;
            margin-top: 8px;
            border-radius: 0 6px 6px 0;
        }

        .card-warning-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 6px;
            font-size: 14px;
            font-weight: 600;
            /* color: var(--warning-color); */
        }

        .card-warning-content {
            font-size: 13px;
            /* color: #fff; */
            line-height: 1.4;
        }

        .card-tip-box {
            background-color: rgba(56, 178, 172, 0.08);
            border-left: 4px solid var(--tip-color);
            padding: 12px 16px;
            margin-top: 8px;
            border-radius: 0 6px 6px 0;
            display: flex;
            align-items: flex-start;
        }

        .card-tip-icon {
            color: var(--tip-color);
            margin-right: 8px;
            font-size: 16px;
            margin-top: 1px;
        }

        .card-tip-content {
            font-size: 13px;
            color: #333;
            line-height: 1.4;
        }

        .card-image-box {
            margin-top: 8px;
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid var(--border-color);
        }

        .card-image {
            width: 100%;
            height: auto;
            object-fit: cover;
        }

        .card-image-caption {
            padding: 8px 12px;
            background: var(--theme-light-grey);
            font-size: 12px;
            color: var(--theme-grey);
            text-align: center;
        }

        .card-checklist-box {
            background-color: var(--theme-light-grey);
            border-radius: 6px;
            padding: 12px 16px;
            margin-top: 8px;
        }

        .card-checklist-item {
            font-size: 13px;
            color: #333;
            display: flex;
            align-items: flex-start;
            gap: 8px;
            margin-bottom: 6px;
        }

        .card-checklist-item:last-child {
            margin-bottom: 0;
        }

        .card-checklist-checkbox {
            color: var(--success-color);
            margin-top: 2px;
        }

        .card-quote-box {
            background-color: rgba(245, 247, 250, 0.8);
            border-left: 4px solid var(--theme-grey);
            padding: 12px 16px;
            margin-top: 8px;
            border-radius: 0 6px 6px 0;
            font-style: italic;
        }

        .card-quote-content {
            font-size: 13px;
            color: var(--theme-grey);
            line-height: 1.5;
        }

        .card-quote-author {
            font-size: 12px;
            color: #999;
            margin-top: 6px;
            text-align: right;
        }

        .card-table-box {
            margin-top: 8px;
            border-radius: 6px;
            overflow: hidden;
            border: 1px solid var(--border-color);
        }

        .card-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }

        .card-table th {
            background: var(--theme-light-grey);
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
            color: var(--theme-black);
            font-weight: 600;
        }

        .card-table td {
            padding: 10px;
            border-bottom: 1px solid var(--border-color);
            color: #333;
        }

        .card-table tr:last-child td {
            border-bottom: none;
        }

        .card-tag-group {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 8px;
        }

        .card-tag {
            padding: 4px 10px;
            background: rgba(var(--theme-accent-rgb, 42, 0, 255), 0.08);
            color: var(--theme-accent);
            border-radius: 20px;
            font-size: 12px;
        }

        /* åº•éƒ¨æé†’åŒº */
        .card-warning-section {
            background-color: var(--theme-black);
            padding: 22px 40px;
            color: #FFFFFF;
            margin-top: auto;
        }

        .card-warning-header {
            display: flex;
            align-items: center;
            margin-bottom: 6px;
        }

        .card-warning-icon {
            font-size: 18px;
            margin-right: 8px;
            color: var(--theme-accent);
        }

        .card-warning-title {
            font-size: 16px;
            font-weight: 700;
            letter-spacing: 0.5px;
        }

        .card-warning-content {
            font-size: 13px;
            line-height: 1.5;
            opacity: 0.9;
            padding-left: 26px;
        }

        /* è£…é¥°å…ƒç´  */
        .card-deco-circle {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 80px;
            height: 80px;
            border: 1px solid var(--theme-light-grey);
            border-radius: 50%;
            z-index: 0;
        }
        .card-deco-circle::after {
            content: "é˜¿é£çš„AIå·¥å…·ç®±";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 12px;
            color: var(--theme-light-grey);
            white-space: nowrap;
        }


        .card-deco-dot {
            position: absolute;
            bottom: 180px;
            left: 80px;
            width: 6px;
            height: 6px;
            background-color: var(--theme-accent);
            border-radius: 50%;
            z-index: 0;
        }

        /* å¯¼å‡ºæ¨¡æ€æ¡† */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            display: none;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: #FFFFFF;
            border-radius: 12px;
            width: 90%;
            max-width: 1000px;
            /* max-height: 85vh; */
            height: 85vh;
            /* overflow-y: auto; */
            padding: 24px;
            display: flex;
            flex-direction: column;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .modal-title {
            font-size: 20px;
            font-weight: 800;
            color: #000;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
        }

        .code-container {
            flex: 1;
            overflow-y: auto;
            background: #F5F7FA;
            border-radius: 8px;
            padding: 16px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 13px;
            line-height: 1.6;
            color: #333;
            white-space: pre-wrap;
            word-break: break-all;
            margin-bottom: 16px;
        }

        .modal-actions {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
        }

        /* å›¾ç‰‡å¯¼å‡ºçŠ¶æ€ */
        .export-status {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 20px 30px;
            border-radius: 10px;
            z-index: 2000;
            display: none;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }

        .export-status.active {
            display: flex;
        }

        .export-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--theme-accent);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* å“åº”å¼è°ƒæ•´ */
        @media (max-width: 1400px) {
            .tool-container {
                flex-direction: column;
            }
            .preview-panel {
                min-width: auto;
            }
        }

        @media (max-width: 768px) {
            .card-preview {
                width: 100%;
                height: auto;
                min-height: 800px;
            }
            .component-list {
                justify-content: center;
            }
            .theme-colors-container {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="tool-container">
        <!-- é…ç½®é¢æ¿ -->
        <div class="config-panel">
            <h2 class="panel-title"><span>ğŸ¨</span> å°çº¢ä¹¦å¡ç‰‡ç”Ÿæˆå·¥å…·ï¼ˆå¢å¼ºç‰ˆï¼‰</h2>

            <!-- ä¸»é¢˜è‰²é…ç½® -->
            <div class="config-group">
                <h3 class="group-label">ä¸»é¢˜è‰²é…ç½® <small>ç‚¹å‡»é€‰æ‹©æˆ–è‡ªå®šä¹‰</small></h3>
                <div class="theme-colors-container" id="themeColors">
                    <!-- é¢„è®¾é¢œè‰²å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
                </div>
                <div class="custom-color-picker">
                    <input type="color" class="color-input" id="customColorPicker" value="#2A00FF">
                    <input type="text" class="form-control custom-hex-input" id="customColorHex" placeholder="#2A00FF" value="#2A00FF">
                </div>
            </div>

            <!-- åŸºç¡€ä¿¡æ¯é…ç½® -->
            <div class="config-group">
                <h3 class="group-label">åŸºç¡€ä¿¡æ¯</h3>
                <input type="text" class="form-control" id="stepNum" placeholder="æ­¥éª¤åºå·ï¼ˆå¦‚ï¼š01ã€02ï¼‰" value="01">
                <input type="text" class="form-control" id="stepEn" placeholder="è‹±æ–‡æ­¥éª¤ï¼ˆå¦‚ï¼šStep Oneï¼‰" value="Step One">
                <input type="text" class="form-control" id="mainTitle" placeholder="å¡ç‰‡ä¸»æ ‡é¢˜" value="ç”Ÿæˆä¸“å±æç¤ºè¯">
                <textarea class="form-control" id="warningContent" placeholder="åº•éƒ¨æé†’å†…å®¹ï¼ˆç”¨æ¢è¡Œåˆ†éš”ï¼‰">â€¢ åŠ¡å¿…å¤åˆ¶ "å…¨éƒ¨æç¤ºè¯"ï¼Œé—æ¼ä¼šå½±å“ AI æ™ºèƒ½ç¨‹åº¦ã€‚
â€¢ å¯å‚è€ƒç« èŠ‚å››ã€Œé…å¥—æç¤ºè¯æ¨¡æ¿ã€ç›´æ¥ä½¿ç”¨ã€‚</textarea>
            </div>

            <!-- ç»„ä»¶é€‰æ‹© -->
            <div class="config-group">
                <h3 class="group-label">ç»„ä»¶åº“ <small>ç‚¹å‡»é€‰æ‹©ç»„ä»¶ç±»å‹</small></h3>
                
                <!-- åŸºç¡€ç»„ä»¶åˆ†ç±» -->
                <div class="component-category">
                    <div class="category-title">åŸºç¡€ç»„ä»¶</div>
                    <div class="component-list">
                        <div class="component-item active" data-type="text" data-name="çº¯æ–‡æœ¬" data-icon="ğŸ“">
                            <span>ğŸ“</span> çº¯æ–‡æœ¬
                        </div>
                        <div class="component-item" data-type="prompt" data-name="æç¤ºè¯æ¡†" data-icon="ğŸ’»">
                            <span>ğŸ’»</span> æç¤ºè¯æ¡†
                        </div>
                        <div class="component-item" data-type="option" data-name="é€‰é¡¹æ¡†" data-icon="ğŸ”˜">
                            <span>ğŸ”˜</span> é€‰é¡¹æ¡†
                        </div>
                        <div class="component-item" data-type="success" data-name="æˆåŠŸæç¤º" data-icon="âœ…">
                            <span>âœ…</span> æˆåŠŸæç¤º
                        </div>
                        <div class="component-item" data-type="format" data-name="æ ¼å¼è¯´æ˜" data-icon="ğŸ“‹">
                            <span>ğŸ“‹</span> æ ¼å¼è¯´æ˜
                        </div>
                        <div class="component-item" data-type="action" data-name="æ“ä½œæç¤º" data-icon="ğŸ’¡">
                            <span>ğŸ’¡</span> æ“ä½œæç¤º
                        </div>
                    </div>
                </div>

                <!-- æ–°å¢ç»„ä»¶åˆ†ç±» -->
                <div class="component-category">
                    <div class="category-title">å¢å¼ºç»„ä»¶</div>
                    <div class="component-list">
                        <div class="component-item" data-type="note" data-name="ç¬”è®°å¡ç‰‡" data-icon="ğŸ““">
                            <span>ğŸ““</span> ç¬”è®°å¡ç‰‡
                        </div>
                        <div class="component-item" data-type="warning" data-name="è­¦å‘Šæç¤º" data-icon="âš ï¸">
                            <span>âš ï¸</span> è­¦å‘Šæç¤º
                        </div>
                        <div class="component-item" data-type="tip" data-name="å°è´´å£«" data-icon="ğŸŒŸ">
                            <span>ğŸŒŸ</span> å°è´´å£«
                        </div>
                        <div class="component-item" data-type="image" data-name="å›¾ç‰‡å±•ç¤º" data-icon="ğŸ–¼ï¸">
                            <span>ğŸ–¼ï¸</span> å›¾ç‰‡å±•ç¤º
                        </div>
                        <div class="component-item" data-type="checklist" data-name="checklist" data-icon="â˜‘ï¸">
                            <span>â˜‘ï¸</span> å‹¾é€‰æ¸…å•
                        </div>
                        <div class="component-item" data-type="quote" data-name="å¼•ç”¨è¯­å½•" data-icon="ğŸ“œ">
                            <span>ğŸ“œ</span> å¼•ç”¨è¯­å½•
                        </div>
                        <div class="component-item" data-type="table" data-name="æ•°æ®è¡¨æ ¼" data-icon="ğŸ“Š">
                            <span>ğŸ“Š</span> æ•°æ®è¡¨æ ¼
                        </div>
                        <div class="component-item" data-type="tags" data-name="æ ‡ç­¾ç»„" data-icon="ğŸ·ï¸">
                            <span>ğŸ·ï¸</span> æ ‡ç­¾ç»„
                        </div>
                    </div>
                </div>

                <button class="btn btn-outline" id="addStep">+ æ·»åŠ æ­¥éª¤</button>
            </div>

            <!-- æ­¥éª¤å†…å®¹é…ç½® -->
            <div class="config-group">
                <h3 class="group-label">æ­¥éª¤å†…å®¹ <small>å…± <span id="stepCount">1</span> ä¸ªæ­¥éª¤</small></h3>
                <div id="stepsContainer">
                    <!-- é»˜è®¤æ­¥éª¤1 -->
                    <div class="step-item">
                        <div class="step-header">
                            <span class="step-title">
                                æ­¥éª¤ 1
                                <span class="step-type-tag" data-type="text">çº¯æ–‡æœ¬</span>
                            </span>
                            <div class="step-actions">
                                <button class="action-btn primary" onclick="editStep(this)">
                                    <span>âœï¸</span> ç¼–è¾‘
                                </button>
                                <button class="action-btn" onclick="deleteStep(this)">
                                    <span>ğŸ—‘ï¸</span> åˆ é™¤
                                </button>
                            </div>
                        </div>
                        <textarea class="form-control" data-type="text" placeholder="æ­¥éª¤å†…å®¹ï¼ˆæ”¯æŒ<strong>åŠ ç²—</strong>ç­‰HTMLæ ‡ç­¾ï¼‰">æ‰“å¼€ <strong>DeepSeek</strong> å®˜ç½‘æˆ– APPï¼Œç™»å½•åæ‰¾åˆ° "å¯¹è¯è¾“å…¥æ¡†"ã€‚</textarea>
                    </div>
                </div>
            </div>

            <div style="display: flex; gap: 10px; margin-top: 20px;">
                <button class="btn btn-outline" id="previewBtn">
                    <span>ğŸ‘ï¸</span> å®æ—¶é¢„è§ˆ
                </button>
                <button class="btn" id="exportImageBtn">
                    <span>ğŸ–¼ï¸</span> å¯¼å‡ºå›¾ç‰‡
                </button>
                <button class="btn" id="exportBtn">
                    <span>ğŸ“¤</span> å¯¼å‡ºHTML
                </button>
            </div>
        </div>

        <!-- é¢„è§ˆé¢æ¿ -->
        <div class="preview-panel">
            <div class="preview-header">
                <h2 class="preview-title">å¡ç‰‡é¢„è§ˆï¼ˆ600Ã—800pxï¼‰</h2>
                <span class="preview-tip">
                    <span>ğŸ“Œ</span> é€‚åˆHTMLè½¬å›¾ç‰‡ï¼Œæ— æ»šåŠ¨æ¡
                </span>
            </div>
            <div class="card-preview" id="cardPreview">
                <!-- é¢„è§ˆå†…å®¹å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
    </div>

    <!-- å¯¼å‡ºæ¨¡æ€æ¡† -->
    <div class="modal" id="exportModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">å¯¼å‡ºHTMLä»£ç </h3>
                <button class="close-modal" id="closeModal">&times;</button>
            </div>
            <div class="code-container" id="codeContainer"></div>
            <div class="modal-actions">
                <button class="btn btn-outline" id="downloadBtn">
                    <span>ğŸ“¥</span> ä¸‹è½½æ–‡ä»¶
                </button>
                <button class="btn" id="copyCodeBtn">
                    <span>ğŸ“‹</span> å¤åˆ¶ä»£ç 
                </button>
            </div>
        </div>
    </div>

    <!-- å›¾ç‰‡å¯¼å‡ºçŠ¶æ€æç¤º -->
    <div class="export-status" id="exportStatus">
        <div class="export-spinner"></div>
        <div>æ­£åœ¨ç”Ÿæˆå›¾ç‰‡ï¼Œè¯·ç¨å€™...</div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let currentComponentType = 'text';
        let stepCount = 1;
        let currentThemeColor = '#2A00FF';
        let currentThemeColorDark = '#1A00CC';

        // é¢„è®¾ä¸»é¢˜è‰²
        const presetColors = [
            { name: 'ç»å…¸è“', value: '#2A00FF', dark: '#1A00CC' },
            { name: 'å°çº¢ä¹¦çº¢', value: '#FF2442', dark: '#CC1D35' },
            { name: 'ç§‘æŠ€ç´«', value: '#7B61FF', dark: '#624DC9' },
            { name: 'æ¸…æ–°ç»¿', value: '#00C48C', dark: '#00A075' },
            { name: 'æ´»åŠ›æ©™', value: '#FF7D00', dark: '#CC6400' },
            { name: 'æ—¶å°šç²‰', value: '#FF4D94', dark: '#CC3D76' },
            { name: 'å•†åŠ¡ç°', value: '#666666', dark: '#4D4D4D' },
            { name: 'æ·±è‰²ç³»', value: '#121212', dark: '#000000' }
        ];

        // DOMå…ƒç´ 
        const stepNumInput = document.getElementById('stepNum');
        const stepEnInput = document.getElementById('stepEn');
        const mainTitleInput = document.getElementById('mainTitle');
        const warningContentInput = document.getElementById('warningContent');
        const stepsContainer = document.getElementById('stepsContainer');
        const cardPreview = document.getElementById('cardPreview');
        const previewBtn = document.getElementById('previewBtn');
        const exportBtn = document.getElementById('exportBtn');
        const exportImageBtn = document.getElementById('exportImageBtn');
        const exportModal = document.getElementById('exportModal');
        const closeModal = document.getElementById('closeModal');
        const codeContainer = document.getElementById('codeContainer');
        const copyCodeBtn = document.getElementById('copyCodeBtn');
        const downloadBtn = document.getElementById('downloadBtn');
        const componentItems = document.querySelectorAll('.component-item');
        const addStepBtn = document.getElementById('addStep');
        const stepCountSpan = document.getElementById('stepCount');
        const themeColorsContainer = document.getElementById('themeColors');
        const customColorPicker = document.getElementById('customColorPicker');
        const customColorHex = document.getElementById('customColorHex');
        const exportStatus = document.getElementById('exportStatus');

        // ç»„ä»¶å…ƒæ•°æ®
        const componentMeta = {
            text: { name: 'çº¯æ–‡æœ¬', icon: 'ğŸ“', defaultContent: 'è¯·è¾“å…¥æ­¥éª¤å†…å®¹ï¼ˆæ”¯æŒ<strong>åŠ ç²—</strong>ç­‰HTMLæ ‡ç­¾ï¼‰' },
            prompt: { name: 'æç¤ºè¯æ¡†', icon: 'ğŸ’»', defaultContent: '<p class="card-prompt-text">"æç¤ºè¯å†…å®¹ç¤ºä¾‹"</p>' },
            option: { name: 'é€‰é¡¹æ¡†', icon: 'ğŸ”˜', defaultContent: '<div class="card-option-item"><span class="card-option-icon">ğŸ”’</span>é€‰é¡¹1ï¼šæè¿°å†…å®¹</div>\n<div class="card-option-item"><span class="card-option-icon">ğŸŒ</span>é€‰é¡¹2ï¼šæè¿°å†…å®¹</div>' },
            success: { name: 'æˆåŠŸæç¤º', icon: 'âœ…', defaultContent: '<span class="card-success-icon">âœ…</span>\n<div class="card-success-content"><strong>æˆåŠŸæç¤ºï¼š</strong>æ“ä½œå®Œæˆåçš„åé¦ˆä¿¡æ¯</div>' },
            format: { name: 'æ ¼å¼è¯´æ˜', icon: 'ğŸ“‹', defaultContent: '<div class="card-format-header">æ”¯æŒæ ¼å¼ï¼š</div>\n<div class="card-format-list"><span>æ ¼å¼1</span><span>æ ¼å¼2</span><span>æ ¼å¼3</span></div>' },
            action: { name: 'æ“ä½œæç¤º', icon: 'ğŸ’¡', defaultContent: '<div class="card-action-text">ğŸ“ æ“ä½œæŒ‡å¼•æˆ–æ³¨æ„äº‹é¡¹è¯´æ˜</div>' },
            note: { name: 'ç¬”è®°å¡ç‰‡', icon: 'ğŸ““', defaultContent: '<div class="card-note-header">ğŸ““ é‡è¦ç¬”è®°</div>\n<div class="card-note-content">è¿™é‡Œæ˜¯éœ€è¦é‡ç‚¹è®°å½•çš„ç¬”è®°å†…å®¹ï¼Œå¯ä»¥åŒ…å«å…³é”®ä¿¡æ¯å’Œè¦ç‚¹</div>' },
            warning: { name: 'è­¦å‘Šæç¤º', icon: 'âš ï¸', defaultContent: '<div class="card-warning-header">âš ï¸ è­¦å‘Š</div>\n<div class="card-warning-content">è¿™é‡Œæ˜¯éœ€è¦ç‰¹åˆ«æ³¨æ„çš„è­¦å‘Šä¿¡æ¯ï¼Œæé†’ç”¨æˆ·é¿å…é”™è¯¯æ“ä½œ</div>' },
            tip: { name: 'å°è´´å£«', icon: 'ğŸŒŸ', defaultContent: '<span class="card-tip-icon">ğŸŒŸ</span>\n<div class="card-tip-content">å®ç”¨å°è´´å£«ï¼šå¯ä»¥æå‡æ“ä½œæ•ˆç‡çš„å°æŠ€å·§æˆ–éšè—åŠŸèƒ½</div>' },
            image: { name: 'å›¾ç‰‡å±•ç¤º', icon: 'ğŸ–¼ï¸', defaultContent: JSON.stringify({ url: 'https://picsum.photos/800/400', caption: 'å›¾ç‰‡è¯´æ˜æ–‡å­—' }) },
            checklist: { name: 'å‹¾é€‰æ¸…å•', icon: 'â˜‘ï¸', defaultContent: '<div class="card-checklist-item"><span class="card-checklist-checkbox">â˜‘ï¸</span>å®Œæˆäº‹é¡¹1</div>\n<div class="card-checklist-item"><span class="card-checklist-checkbox">â˜‘ï¸</span>å®Œæˆäº‹é¡¹2</div>\n<div class="card-checklist-item"><span class="card-checklist-checkbox">â–¡</span>å¾…åŠäº‹é¡¹3</div>' },
            quote: { name: 'å¼•ç”¨è¯­å½•', icon: 'ğŸ“œ', defaultContent: '<div class="card-quote-content">"è¿™é‡Œæ˜¯å¼•ç”¨çš„åè¨€ã€è§‚ç‚¹æˆ–é‡è¦è¯­å¥"</div>\n<div class="card-quote-author">â€” ä½œè€…åç§°</div>' },
            table: { name: 'æ•°æ®è¡¨æ ¼', icon: 'ğŸ“Š', defaultContent: JSON.stringify([
                ['è¡¨å¤´1', 'è¡¨å¤´2', 'è¡¨å¤´3'],
                ['æ•°æ®1', 'æ•°æ®2', 'æ•°æ®3'],
                ['æ•°æ®4', 'æ•°æ®5', 'æ•°æ®6']
            ]) },
            tags: { name: 'æ ‡ç­¾ç»„', icon: 'ğŸ·ï¸', defaultContent: 'æ ‡ç­¾1,æ ‡ç­¾2,æ ‡ç­¾3,æ ‡ç­¾4,æ ‡ç­¾5' }
        };

        // åˆå§‹åŒ–ä¸»é¢˜è‰²é€‰æ‹©å™¨
        function initThemeColors() {
            presetColors.forEach(color => {
                const colorItem = document.createElement('div');
                colorItem.className = 'theme-color-item';
                colorItem.innerHTML = `
                    <div class="theme-color-preview" style="background-color: ${color.value}"></div>
                    <div>${color.name}</div>
                `;
                colorItem.dataset.value = color.value;
                colorItem.dataset.dark = color.dark;
                colorItem.addEventListener('click', () => {
                    setThemeColor(color.value, color.dark);
                });
                themeColorsContainer.appendChild(colorItem);
            });
        }

        // è®¾ç½®ä¸»é¢˜è‰²
        function setThemeColor(color, darkColor = null) {
            currentThemeColor = color;
            currentThemeColorDark = darkColor || getDarkColor(color);
            
            // æ›´æ–°é¢œè‰²è¾“å…¥
            customColorPicker.value = color;
            customColorHex.value = color;
            
            // æ›´æ–°CSSå˜é‡
            const r = parseInt(color.substr(1, 2), 16);
            const g = parseInt(color.substr(3, 2), 16);
            const b = parseInt(color.substr(5, 2), 16);
            
            document.documentElement.style.setProperty('--theme-accent', color);
            document.documentElement.style.setProperty('--theme-accent-dark', currentThemeColorDark);
            document.documentElement.style.setProperty('--theme-accent-light', `${color}1A`);
            document.documentElement.style.setProperty('--theme-accent-rgb', `${r}, ${g}, ${b}`);
            
            updatePreview();
        }

        // è·å–æ·±è‰²ç‰ˆæœ¬é¢œè‰²
        function getDarkColor(color) {
            // ç®€åŒ–çš„é¢œè‰²å˜æš—ç®—æ³•
            const hex = color.replace('#', '');
            const r = Math.floor(parseInt(hex.substr(0, 2), 16) * 0.7);
            const g = Math.floor(parseInt(hex.substr(2, 2), 16) * 0.7);
            const b = Math.floor(parseInt(hex.substr(4, 2), 16) * 0.7);
            
            return `#${r.toString(16).padStart(2, '0')}${g.toString(16).padStart(2, '0')}${b.toString(16).padStart(2, '0')}`;
        }

        // åˆå§‹åŒ–é¢„è§ˆ
        window.addEventListener('load', () => {
            initThemeColors();
            updatePreview();
        });
        stepCountSpan.textContent = stepCount;

        // ç»„ä»¶ç±»å‹é€‰æ‹©
        componentItems.forEach(item => {
            item.addEventListener('click', () => {
                componentItems.forEach(i => i.classList.remove('active'));
                item.classList.add('active');
                currentComponentType = item.dataset.type;
            });
        });

        // æ·»åŠ æ­¥éª¤
        addStepBtn.addEventListener('click', () => {
            stepCount++;
            stepCountSpan.textContent = stepCount;
            
            const meta = componentMeta[currentComponentType];
            const stepItem = document.createElement('div');
            stepItem.className = 'step-item';
            
            // æ ¹æ®ç»„ä»¶ç±»å‹ç”Ÿæˆä¸åŒçš„å†…å®¹
            let content = meta.defaultContent;
            let textareaPlaceholder = '';
            
            if (currentComponentType === 'image' || currentComponentType === 'table') {
                textareaPlaceholder = `è¯·è¾“å…¥${meta.name}çš„JSONé…ç½®`;
            } else if (currentComponentType === 'tags') {
                textareaPlaceholder = `è¯·è¾“å…¥æ ‡ç­¾ï¼Œç”¨é€—å·åˆ†éš”`;
            } else {
                textareaPlaceholder = `è¯·è¾“å…¥${meta.name}å†…å®¹`;
            }
            
            stepItem.innerHTML = `
                <div class="step-header">
                    <span class="step-title">
                        æ­¥éª¤ ${stepCount}
                        <span class="step-type-tag" data-type="${currentComponentType}">${meta.name}</span>
                    </span>
                    <div class="step-actions">
                        <button class="action-btn primary" onclick="editStep(this)">
                            <span>âœï¸</span> ç¼–è¾‘
                        </button>
                        <button class="action-btn" onclick="deleteStep(this)">
                            <span>ğŸ—‘ï¸</span> åˆ é™¤
                        </button>
                    </div>
                </div>
                <textarea class="form-control" data-type="${currentComponentType}" placeholder="${textareaPlaceholder}">${content}</textarea>
            `;
            
            stepsContainer.appendChild(stepItem);
            
            // æ·»åŠ è¾“å…¥ç›‘å¬
            stepItem.querySelector('textarea').addEventListener('input', debounce(updatePreview, 300));
            updatePreview();
        });

        // ç¼–è¾‘æ­¥éª¤ï¼ˆåˆ‡æ¢ç»„ä»¶ç±»å‹ï¼‰
        window.editStep = function(btn) {
            const stepItem = btn.closest('.step-item');
            const textarea = stepItem.querySelector('textarea');
            const currentType = textarea.dataset.type;
            const typeTag = stepItem.querySelector('.step-type-tag');
            const currentContent = textarea.value.trim();
            
            // ç”Ÿæˆç»„ä»¶ç±»å‹é€‰æ‹©åˆ—è¡¨
            let optionsText = 'è¯·é€‰æ‹©æ–°çš„ç»„ä»¶ç±»å‹ï¼š\n';
            Object.keys(componentMeta).forEach(type => {
                const meta = componentMeta[type];
                optionsText += `${currentType === type ? 'âœ“' : ' '} ${type}: ${meta.icon} ${meta.name}\n`;
            });
            
            const newType = prompt(optionsText, currentType);
            
            if (!newType || !componentMeta[newType] || newType === currentType) return;
            
            // æ›´æ–°ç»„ä»¶ç±»å‹
            const newMeta = componentMeta[newType];
            textarea.dataset.type = newType;
            typeTag.dataset.type = newType;
            typeTag.textContent = newMeta.name;
            
            // å¦‚æœå½“å‰å†…å®¹æ˜¯é»˜è®¤å†…å®¹æˆ–æ ¼å¼ä¸åŒ¹é…ï¼Œåˆ™æ›´æ–°ä¸ºæ–°çš„é»˜è®¤å†…å®¹
            if (currentContent === componentMeta[currentType].defaultContent || 
                (newType === 'image' && !isJsonContent(currentContent)) ||
                (newType === 'table' && !isJsonContent(currentContent)) ||
                (newType === 'tags' && !isCommaSeparated(currentContent))) {
                textarea.value = newMeta.defaultContent;
            }
            
            // æ›´æ–°å ä½ç¬¦
            if (newType === 'image' || newType === 'table') {
                textarea.placeholder = `è¯·è¾“å…¥${newMeta.name}çš„JSONé…ç½®`;
            } else if (newType === 'tags') {
                textarea.placeholder = `è¯·è¾“å…¥æ ‡ç­¾ï¼Œç”¨é€—å·åˆ†éš”`;
            } else {
                textarea.placeholder = `è¯·è¾“å…¥${newMeta.name}å†…å®¹`;
            }

            updatePreview();
        };

        // åˆ¤æ–­æ˜¯å¦ä¸ºJSONå†…å®¹
        function isJsonContent(content) {
            try {
                JSON.parse(content);
                return true;
            } catch (e) {
                return false;
            }
        }

        // åˆ¤æ–­æ˜¯å¦ä¸ºé€—å·åˆ†éš”å†…å®¹
        function isCommaSeparated(content) {
            return content.split(',').length > 1;
        }

        // åˆ é™¤æ­¥éª¤
        window.deleteStep = function(btn) {
            if (stepCount <= 1) {
                alert('è‡³å°‘ä¿ç•™ä¸€ä¸ªæ­¥éª¤');
                return;
            }
            
            const stepItem = btn.closest('.step-item');
            stepItem.remove();
            stepCount--;
            stepCountSpan.textContent = stepCount;
            
            // æ›´æ–°æ­¥éª¤åºå·
            const stepItems = document.querySelectorAll('.step-item');
            stepItems.forEach((item, index) => {
                const type = item.querySelector('textarea').dataset.type;
                item.querySelector('.step-title').innerHTML = `
                    æ­¥éª¤ ${index + 1}
                    <span class="step-type-tag" data-type="${type}">
                        ${componentMeta[type].name}
                    </span>
                `;
            });

            updatePreview();
        };

        // ç”Ÿæˆç»„ä»¶HTML
        function generateComponentHtml(type, content) {
            const trimmedContent = content.trim();
            
            switch(type) {
                case 'text':
                    return `<div class="card-step-text">${trimmedContent || 'æ— å†…å®¹'}</div>`;
                    
                case 'prompt':
                    if (trimmedContent.includes('<p class="card-prompt-text">')) {
                        return `<div class="card-prompt-box">${trimmedContent}</div>`;
                    }
                    return `<div class="card-prompt-box"><p class="card-prompt-text">${trimmedContent || 'æ— å†…å®¹'}</p></div>`;
                    
                case 'option':
                    if (trimmedContent.includes('<div class="card-option-item">')) {
                        return `<div class="card-option-box">${trimmedContent}</div>`;
                    }
                    return `<div class="card-option-box"><div class="card-option-item"><span class="card-option-icon">ğŸ”˜</span>${trimmedContent || 'æ— å†…å®¹'}</div></div>`;
                    
                case 'success':
                    if (trimmedContent.includes('<span class="card-success-icon">')) {
                        return `<div class="card-success-box">${trimmedContent}</div>`;
                    }
                    return `<div class="card-success-box"><span class="card-success-icon">âœ…</span><div class="card-success-content">${trimmedContent || 'æ— å†…å®¹'}</div></div>`;
                    
                case 'format':
                    if (trimmedContent.includes('<div class="card-format-header">')) {
                        return `<div class="card-format-box">${trimmedContent}</div>`;
                    }
                    return `<div class="card-format-box"><div class="card-format-header">æ ¼å¼è¯´æ˜ï¼š</div><div class="card-format-list"><span>${trimmedContent || 'æ— å†…å®¹'}</span></div></div>`;
                    
                case 'action':
                    if (trimmedContent.includes('<div class="card-action-text">')) {
                        return `<div class="card-action-hint">${trimmedContent}</div>`;
                    }
                    return `<div class="card-action-hint"><div class="card-action-text">${trimmedContent || 'æ— å†…å®¹'}</div></div>`;
                    
                case 'note':
                    if (trimmedContent.includes('<div class="card-note-header">')) {
                        return `<div class="card-note-box">${trimmedContent}</div>`;
                    }
                    return `<div class="card-note-box"><div class="card-note-header">ğŸ““ ç¬”è®°</div><div class="card-note-content">${trimmedContent || 'æ— å†…å®¹'}</div></div>`;
                    
                case 'warning':
                    if (trimmedContent.includes('<div class="card-warning-header">')) {
                        return `<div class="card-warning-box">${trimmedContent}</div>`;
                    }
                    return `<div class="card-warning-box"><div class="card-warning-header">âš ï¸ è­¦å‘Š</div><div class="card-warning-content">${trimmedContent || 'æ— å†…å®¹'}</div></div>`;
                    
                case 'tip':
                    if (trimmedContent.includes('<span class="card-tip-icon">')) {
                        return `<div class="card-tip-box">${trimmedContent}</div>`;
                    }
                    return `<div class="card-tip-box"><span class="card-tip-icon">ğŸŒŸ</span><div class="card-tip-content">${trimmedContent || 'æ— å†…å®¹'}</div></div>`;
                    
                case 'image':
                    try {
                        const { url, caption } = JSON.parse(trimmedContent || '{}');
                        return `
                            <div class="card-image-box">
                                <img src="${url || 'https://picsum.photos/800/400'}" alt="${caption || 'å›¾ç‰‡'}" class="card-image">
                                ${caption ? `<div class="card-image-caption">${caption}</div>` : ''}
                            </div>
                        `;
                    } catch (e) {
                        return `
                            <div class="card-image-box">
                                <img src="https://picsum.photos/800/400" alt="é»˜è®¤å›¾ç‰‡" class="card-image">
                                <div class="card-image-caption">å›¾ç‰‡è¯´æ˜</div>
                            </div>
                        `;
                    }
                    
                case 'checklist':
                    if (trimmedContent.includes('<div class="card-checklist-item">')) {
                        return `<div class="card-checklist-box">${trimmedContent}</div>`;
                    }
                    return `<div class="card-checklist-box"><div class="card-checklist-item"><span class="card-checklist-checkbox">â˜‘ï¸</span>${trimmedContent || 'æ— å†…å®¹'}</div></div>`;
                    
                case 'quote':
                    if (trimmedContent.includes('<div class="card-quote-content">')) {
                        return `<div class="card-quote-box">${trimmedContent}</div>`;
                    }
                    return `<div class="card-quote-box"><div class="card-quote-content">"${trimmedContent || 'æ— å†…å®¹'}"</div></div>`;
                    
                case 'table':
                    try {
                        const tableData = JSON.parse(trimmedContent || '[]');
                        if (!Array.isArray(tableData) || tableData.length === 0) {
                            throw new Error('è¡¨æ ¼æ•°æ®æ ¼å¼é”™è¯¯');
                        }
                        
                        let tableHtml = '<div class="card-table-box"><table class="card-table"><thead><tr>';
                        // è¡¨å¤´
                        tableData[0].forEach(th => {
                            tableHtml += `<th>${th}</th>`;
                        });
                        tableHtml += '</tr></thead><tbody>';
                        
                        // è¡¨ä½“
                        for (let i = 1; i < tableData.length; i++) {
                            tableHtml += '<tr>';
                            tableData[i].forEach(td => {
                                tableHtml += `<td>${td}</td>`;
                            });
                            tableHtml += '</tr>';
                        }
                        
                        tableHtml += '</tbody></table></div>';
                        return tableHtml;
                    } catch (e) {
                        return `
                            <div class="card-table-box">
                                <table class="card-table">
                                    <thead><tr><th>è¡¨å¤´1</th><th>è¡¨å¤´2</th></tr></thead>
                                    <tbody><tr><td>æ•°æ®1</td><td>æ•°æ®2</td></tr></tbody>
                                </table>
                            </div>
                        `;
                    }
                    
                case 'tags':
                    const tags = trimmedContent.split(',').map(tag => tag.trim()).filter(tag => tag);
                    if (tags.length === 0) tags.push('æ ‡ç­¾1', 'æ ‡ç­¾2', 'æ ‡ç­¾3');
                    
                    let tagsHtml = '<div class="card-tag-group">';
                    tags.forEach(tag => {
                        tagsHtml += `<span class="card-tag">${tag}</span>`;
                    });
                    tagsHtml += '</div>';
                    return tagsHtml;
                    
                default:
                    return `<div class="card-step-text">${trimmedContent || 'æ— å†…å®¹'}</div>`;
            }
        }

        // æ›´æ–°é¢„è§ˆ
        function updatePreview() {
            const stepNum = stepNumInput.value;
            const stepEn = stepEnInput.value;
            const mainTitle = mainTitleInput.value;
            const warningContent = warningContentInput.value.replace(/\n/g, '<br>');
            
            // æ”¶é›†æ­¥éª¤å†…å®¹
            const stepItems = document.querySelectorAll('.step-item');
            let stepsHtml = '';
            
            stepItems.forEach((item, index) => {
                const textarea = item.querySelector('textarea');
                const content = textarea.value;
                const type = textarea.dataset.type;
                
                const stepContentHtml = generateComponentHtml(type, content);
                
                stepsHtml += `
                    <div class="card-step-row">
                        <div class="card-step-num">${index + 1}</div>
                        <div class="card-step-content">
                            ${stepContentHtml}
                        </div>
                    </div>
                `;
            });

            // ç”Ÿæˆå®Œæ•´å¡ç‰‡HTML
            const cardHtml = `
                <div class="card-header">
                    <div class="card-step-indicator">${stepNum}</div>
                    <div class="card-step-title-group">
                        <span class="card-step-label">${stepEn}</span>
                        <h1 class="card-main-title">${mainTitle}</h1>
                    </div>
                    <div class="card-deco-circle"></div>
                </div>
                <div class="card-content">
                    <div class="card-timeline-line"></div>
                    ${stepsHtml}
                </div>
                <div class="card-warning-section">
                    <div class="card-warning-header">
                        <span class="card-warning-icon">ğŸ“Œ</span>
                        <span class="card-warning-title">é‡ç‚¹æé†’</span>
                    </div>
                    <div class="card-warning-content">
                        ${warningContent}
                    </div>
                </div>
            `;

            // æ›´æ–°é¢„è§ˆ
            cardPreview.innerHTML = cardHtml;
        }

        // é˜²æŠ–å‡½æ•°
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // é¢„è§ˆæŒ‰é’®ç‚¹å‡»
        previewBtn.addEventListener('click', updatePreview);

        // å¯¼å‡ºå›¾ç‰‡åŠŸèƒ½
        exportImageBtn.addEventListener('click', () => {
            exportStatus.classList.add('active');
            
            // ä½¿ç”¨html2canvasæˆªå›¾
            html2canvas(cardPreview, {
                scale: 2, // æé«˜åˆ†è¾¨ç‡
                backgroundColor: '#FFFFFF',
                useCORS: true, // å…è®¸è·¨åŸŸå›¾ç‰‡
                logging: false
            }).then(canvas => {
                // åˆ›å»ºä¸‹è½½é“¾æ¥
                const link = document.createElement('a');
                const fileName = `å°çº¢ä¹¦å¡ç‰‡_${stepNumInput.value}_${Date.now()}.png`;
                
                link.download = fileName;
                link.href = canvas.toDataURL('image/png');
                link.click();
                
                exportStatus.classList.remove('active');
            }).catch(error => {
                console.error('å›¾ç‰‡å¯¼å‡ºå¤±è´¥:', error);
                alert('å›¾ç‰‡å¯¼å‡ºå¤±è´¥ï¼Œè¯·æ£€æŸ¥æµè§ˆå™¨å…¼å®¹æ€§æˆ–é‡è¯•');
                exportStatus.classList.remove('active');
            });
        });

        // å¯¼å‡ºHTML
        exportBtn.addEventListener('click', () => {
            updatePreview();
            
            const stepNum = stepNumInput.value;
            const mainTitle = mainTitleInput.value;
            
            // ç”Ÿæˆå®Œæ•´HTMLä»£ç 
            const fullHtml = `<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°çº¢ä¹¦æç®€å¡ç‰‡ - æ­¥éª¤${stepNum}</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            background-color: #E5E5E5;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            font-family: 'Source Han Sans CN', 'Roboto', Helvetica, Arial, sans-serif;
        }

        .card-container {
            width: 600px;
            height: 800px;
            background-color: #FFFFFF;
            position: relative;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        :root {
            --theme-black: #000000;
            --theme-grey: #666666;
            --theme-light-grey: #F5F7FA;
            --theme-accent: ${currentThemeColor};
            --theme-accent-dark: ${currentThemeColorDark};
            --theme-accent-light: ${currentThemeColor}1A;
            --border-color: #E0E0E0;
            --success-color: #00C48C;
            --info-color: #4299E1;
            --warning-color: #FF7D00;
            --danger-color: #F53F3F;
            --note-color: #9F7AEA;
            --tip-color: #38B2AC;
        }

        .card-header {
            background-color: #FFFFFF;
            padding: 30px 40px 15px;
            border-bottom: 4px solid var(--theme-accent);
            display: flex;
            align-items: baseline;
            justify-content: space-between;
        }

        .card-step-indicator {
            font-size: 72px;
            font-weight: 900;
            color: var(--theme-accent);
            line-height: 0.8;
            font-style: italic;
        }

        .card-step-title-group {
            text-align: right;
        }

        .card-step-label {
            display: block;
            font-size: 14px;
            font-weight: 700;
            color: var(--theme-black);
            letter-spacing: 1.5px;
            text-transform: uppercase;
        }

        .card-main-title {
            font-size: 24px;
            font-weight: 800;
            color: var(--theme-black);
            margin-top: 3px;
        }

        .card-content {
            padding: 30px 40px;
            flex-grow: 1;
            position: relative;
        }

        .card-timeline-line {
            position: absolute;
            left: 54px;
            top: 40px;
            bottom: 30px;
            width: 2px;
            background-color: var(--theme-light-grey);
            z-index: 0;
        }

        .card-step-row {
            display: flex;
            margin-bottom: 22px;
            position: relative;
            z-index: 1;
        }

        .card-step-num {
            flex-shrink: 0;
            width: 30px;
            height: 30px;
            background-color: var(--theme-black);
            color: #FFFFFF;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 15px;
            margin-right: 18px;
            margin-top: 1px;
        }

        .card-step-content {
            flex-grow: 1;
        }

        .card-step-text {
            font-size: 16px;
            color: #333;
            line-height: 1.4;
            font-weight: 500;
        }

        .card-step-text strong {
            color: var(--theme-accent);
        }

        .card-prompt-box {
            background-color: var(--theme-light-grey);
            border-left: 4px solid var(--theme-accent);
            padding: 12px 16px;
            margin-top: 8px;
            border-radius: 0 6px 6px 0;
        }

        .card-prompt-text {
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 13px;
            color: #444;
            line-height: 1.5;
        }

        .card-option-box {
            background-color: var(--theme-accent-light);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 10px 14px;
            margin-top: 8px;
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .card-option-item {
            font-size: 13px;
            color: var(--theme-black);
            display: flex;
            align-items: center;
        }

        .card-option-icon {
            margin-right: 8px;
            font-size: 14px;
        }

        .card-success-box {
            background-color: rgba(0, 196, 140, 0.08);
            border-left: 4px solid var(--success-color);
            padding: 10px 14px;
            margin-top: 8px;
            border-radius: 0 6px 6px 0;
            display: flex;
            align-items: flex-start;
        }

        .card-success-icon {
            color: var(--success-color);
            margin-right: 8px;
            font-size: 16px;
            margin-top: 1px;
        }

        .card-success-content {
            font-size: 13px;
            color: #333;
            line-height: 1.4;
        }

        .card-format-box {
            background-color: rgba(66, 153, 225, 0.05);
            border: 1px solid var(--info-color);
            border-radius: 6px;
            padding: 10px 14px;
            margin-top: 8px;
        }

        .card-format-header {
            font-size: 13px;
            color: var(--info-color);
            font-weight: 600;
            margin-bottom: 4px;
        }

        .card-format-list {
            font-size: 12px;
            color: var(--theme-grey);
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .card-action-hint {
            background-color: var(--theme-accent-light);
            border-left: 4px solid var(--theme-accent);
            padding: 10px 14px;
            margin-top: 8px;
            border-radius: 0 6px 6px 0;
        }

        .card-action-text {
            font-size: 13px;
            color: var(--theme-black);
            line-height: 1.4;
        }

        .card-note-box {
            background-color: rgba(159, 122, 234, 0.08);
            border-left: 4px solid var(--note-color);
            padding: 12px 16px;
            margin-top: 8px;
            border-radius: 0 6px 6px 0;
        }

        .card-note-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 6px;
            font-size: 14px;
            font-weight: 600;
            color: var(--note-color);
        }

        .card-note-content {
            font-size: 13px;
            color: #333;
            line-height: 1.4;
        }

        .card-warning-box {
            background-color: rgba(255, 125, 0, 0.08);
            border-left: 4px solid var(--warning-color);
            padding: 12px 16px;
            margin-top: 8px;
            border-radius: 0 6px 6px 0;
        }

        .card-warning-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 6px;
            font-size: 14px;
            font-weight: 600;
            color: var(--warning-color);
        }

        .card-warning-content {
            font-size: 13px;
            color: #333;
            line-height: 1.4;
        }

        .card-tip-box {
            background-color: rgba(56, 178, 172, 0.08);
            border-left: 4px solid var(--tip-color);
            padding: 12px 16px;
            margin-top: 8px;
            border-radius: 0 6px 6px 0;
            display: flex;
            align-items: flex-start;
        }

        .card-tip-icon {
            color: var(--tip-color);
            margin-right: 8px;
            font-size: 16px;
            margin-top: 1px;
        }

        .card-tip-content {
            font-size: 13px;
            color: #333;
            line-height: 1.4;
        }

        .card-image-box {
            margin-top: 8px;
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid var(--border-color);
        }

        .card-image {
            width: 100%;
            height: auto;
            object-fit: cover;
        }

        .card-image-caption {
            padding: 8px 12px;
            background: var(--theme-light-grey);
            font-size: 12px;
            color: var(--theme-grey);
            text-align: center;
        }

        .card-checklist-box {
            background-color: var(--theme-light-grey);
            border-radius: 6px;
            padding: 12px 16px;
            margin-top: 8px;
        }

        .card-checklist-item {
            font-size: 13px;
            color: #333;
            display: flex;
            align-items: flex-start;
            gap: 8px;
            margin-bottom: 6px;
        }

        .card-checklist-item:last-child {
            margin-bottom: 0;
        }

        .card-checklist-checkbox {
            color: var(--success-color);
            margin-top: 2px;
        }

        .card-quote-box {
            background-color: rgba(245, 247, 250, 0.8);
            border-left: 4px solid var(--theme-grey);
            padding: 12px 16px;
            margin-top: 8px;
            border-radius: 0 6px 6px 0;
            font-style: italic;
        }

        .card-quote-content {
            font-size: 13px;
            color: var(--theme-grey);
            line-height: 1.5;
        }

        .card-quote-author {
            font-size: 12px;
            color: #999;
            margin-top: 6px;
            text-align: right;
        }

        .card-table-box {
            margin-top: 8px;
            border-radius: 6px;
            overflow: hidden;
            border: 1px solid var(--border-color);
        }

        .card-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }

        .card-table th {
            background: var(--theme-light-grey);
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
            color: var(--theme-black);
            font-weight: 600;
        }

        .card-table td {
            padding: 10px;
            border-bottom: 1px solid var(--border-color);
            color: #333;
        }

        .card-table tr:last-child td {
            border-bottom: none;
        }

        .card-tag-group {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 8px;
        }

        .card-tag {
            padding: 4px 10px;
            background: var(--theme-accent-light);
            color: var(--theme-accent);
            border-radius: 20px;
            font-size: 12px;
        }

        .card-warning-section {
            background-color: var(--theme-black);
            padding: 22px 40px;
            color: #FFFFFF;
            margin-top: auto;
        }

        .card-warning-header {
            display: flex;
            align-items: center;
            margin-bottom: 6px;
        }

        .card-warning-icon {
            font-size: 18px;
            margin-right: 8px;
            color: var(--theme-accent);
        }

        .card-warning-title {
            font-size: 16px;
            font-weight: 700;
            letter-spacing: 0.5px;
        }

        .card-warning-content {
            font-size: 13px;
            line-height: 1.5;
            opacity: 0.9;
            padding-left: 26px;
        }

        .card-deco-circle {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 80px;
            height: 80px;
            border: 1px solid var(--theme-light-grey);
            border-radius: 50%;
            z-index: 0;
            content: "é˜¿é£çš„AI";
        }

        .card-deco-dot {
            position: absolute;
            bottom: 180px;
            left: 80px;
            width: 6px;
            height: 6px;
            background-color: var(--theme-accent);
            border-radius: 50%;
            z-index: 0;
        }
    </style>
</head>
<body>
    <main class="card-container">
        ${cardPreview.innerHTML}
    </main>
</body>
</html>`;

            // æ˜¾ç¤ºä»£ç 
            codeContainer.textContent = fullHtml;
            exportModal.classList.add('active');
        });

        // å…³é—­æ¨¡æ€æ¡†
        closeModal.addEventListener('click', () => {
            exportModal.classList.remove('active');
        });

        // å¤åˆ¶ä»£ç 
        copyCodeBtn.addEventListener('click', () => {
            const code = codeContainer.textContent;
            navigator.clipboard.writeText(code).then(() => {
                alert('ä»£ç å¤åˆ¶æˆåŠŸï¼å¯ç›´æ¥ç²˜è´´åˆ°HTMLæ–‡ä»¶ä¸­ä½¿ç”¨');
            }).catch(err => {
                alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶');
                console.error('å¤åˆ¶å¤±è´¥:', err);
            });
        });

        // ä¸‹è½½HTMLæ–‡ä»¶
        downloadBtn.addEventListener('click', () => {
            const code = codeContainer.textContent;
            const blob = new Blob([code], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `å°çº¢ä¹¦å¡ç‰‡_æ­¥éª¤${stepNumInput.value}.html`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
        });

        // é¢œè‰²é€‰æ‹©å™¨äº‹ä»¶
        customColorPicker.addEventListener('input', (e) => {
            const color = e.target.value;
            customColorHex.value = color;
            setThemeColor(color);
        });

        customColorHex.addEventListener('input', debounce((e) => {
            const color = e.target.value;
            if (/^#[0-9A-F]{6}$/i.test(color)) {
                customColorPicker.value = color;
                setThemeColor(color);
            }
        }, 500));

        // å®æ—¶ç›‘å¬è¾“å…¥å˜åŒ–
        const allInputs = document.querySelectorAll('.form-control, textarea.form-control');
        allInputs.forEach(input => {
            input.addEventListener('input', debounce(updatePreview, 300));
        });
    </script>
</body>
</html>